/* =========================
   Design tokens
   ========================= */
:root{
  --bg:#ffffff;
  --ink:#111318;
  --muted:#5b6270;
  --border:#e7e8ee;
  --surface:#f7f7fb;
  --accent:#00c853;
  --p1:#3b82f6;
  --p2:#ef4444;
  --radius:16px;
  --shadow:0 10px 30px rgba(17,19,24,.10);
  --economy:#f59e0b;
  --focus:#2563eb;
}

/* =========================
   Global
   ========================= */
*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  font:16px/1.5 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  color:var(--ink);
  background:var(--surface);
}
.wrap{ max-width:1200px; margin:auto; padding:24px; }
h1{ font-size:24px; margin:0 0 8px; }
.sub{ color:var(--muted); margin:0 0 20px; }

/* =========================
   Layout panels
   ========================= */
.row{
  display:grid;
  grid-template-columns:1fr 500px 1fr;
  gap:18px;
}
.panel{
  background:#fff;
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
}
.panel header{
  padding:10px 14px;
  border-bottom:1px solid var(--border);
  font-weight:700;
}
.panel .body{ padding:12px 14px; }

/* =========================
   Controls
   ========================= */
.controls{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  margin-bottom:12px;
  align-items:center;
}
.player-controls{ margin-top:6px; }

button{
  appearance:none;
  border:1px solid var(--border);
  border-radius:12px;
  padding:12px 16px;
  background:#fff;
  cursor:pointer;
  font-weight:700;
}
button.primary{ background:var(--accent); color:#fff; border-color:transparent; }
button:disabled{ opacity:.55; cursor:not-allowed; }
.btn-toggled{ outline:3px solid var(--focus); outline-offset:2px; }

button:focus-visible,
select:focus-visible,
textarea:focus-visible,
input:focus-visible{
  outline:3px solid var(--focus);
  outline-offset:2px;
}

select,
input[type="checkbox"],
input[type="text"],
textarea{
  padding:8px 10px;
  border:1px solid var(--border);
  border-radius:10px;
  background:#fff;
}

label.inline{
  display:flex;
  align-items:center;
  gap:8px;
  font-size:13px;
  color:var(--muted);
}

/* =========================
   Stacks and columns
   ========================= */
.cols{
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  gap:14px;
}
.stack{ min-height:160px; }
.stack h3{ font-size:14px; color:var(--muted); margin:0 0 6px; }

/* =========================
   Cards container
   ========================= */
.cards{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
}

/* =========================
   Card component
   ========================= */
/* Single source of truth for size:
   width + aspect-ratio; height is computed. */
.card{
  width:220px;                 /* can be overridden via media query */
  aspect-ratio:2 / 3;

  background:#fff;
  border:1.5px solid var(--border);
  border-radius:14px;
  box-shadow:0 2px 8px rgba(0,0,0,.06);
  overflow:hidden;

  display:flex;
  flex-direction:column;

  /* Ensure rounded corners clip full-bleed art */
  -webkit-mask-image: -webkit-radial-gradient(white, black);
}

/* The art region expands to fill remaining space. */
.card .art{
  position:relative;
  flex:1 1 auto;
  min-height:0;
  border-bottom:1px solid var(--border);
  overflow:hidden;
  display:block;               /* grid/center not needed; art is absolute */
}

/* Any bg DIV we inject becomes a full-bleed layer. */
.card .art > div[style*="background"]{
  position:absolute;
  inset:0;
  background-repeat:no-repeat;
  background-position:center;
  background-size:cover;       /* makes PNGs fill reliably */
}

/* If an SVG is used, it behaves like the PNG layer. */
.card .art > svg{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  display:block;
}

/* Optional badge chip that floats above the art. */
.badgechip{
  position:absolute;
  top:6px;
  left:6px;
  background:#111318cc;
  color:#fff;
  font-size:10px;
  padding:3px 6px;
  border-radius:999px;
  z-index:1;
}

/* Card footer/meta */
.card .meta{ padding:8px 10px; background:linear-gradient(0deg, rgba(255,255,255,.98), rgba(255,255,255,.90)); }
.card .name{ font-size:14px; font-weight:800; line-height:1.25; }
.card .tags{ font-size:11px; color:var(--muted); }

/* Clickable selection state */
.card.clickable{
  outline:2px dashed var(--accent);
  outline-offset:2px;
  cursor:pointer;
}

/* =========================
   Player panels and misc
   ========================= */
.pwrap{ display:grid; grid-template-columns:1fr; gap:12px; }
.pbox{ border:1px solid var(--border); border-radius:12px; padding:10px; }
.pbox h4{ margin:0 0 6px; font-size:14px; }
.p1 .pbox h4{ color:var(--p1); }
.p2 .pbox h4{ color:var(--p2); }

.scoreline{
  display:flex;
  gap:10px;
  font-size:13px;
  color:var(--muted);
}
.scoreline .v{ font-weight:800; color:var(--ink); }

.battlefield{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;
  padding-top:8px;
}

.turn{ margin-top:6px; font-size:13px; color:var(--muted); }

.log{
  font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
  font-size:13px;
  color:#2b2f36;
  max-height:280px;
  overflow:auto;
  white-space:pre-wrap;
}

.sr-only{
  position:absolute;
  left:-9999px;
  width:1px;
  height:1px;
  overflow:hidden;
}

/* =========================
   Modal
   ========================= */
.modal{
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  background:rgba(17,19,24,.5);
  z-index:1000;
}
.modal.show{ display:flex; }
.modal-card{
  background:#fff;
  border:1px solid var(--border);
  border-radius:16px;
  box-shadow:var(--shadow);
  max-width:440px;
  width:calc(100% - 40px);
  padding:18px;
}
.modal-card h3{ margin:0 0 10px; font-size:20px; }
.modal-card p{ margin:0 0 14px; color:var(--muted); }
.modal-actions{ display:flex; justify-content:flex-end; gap:8px; }

/* === Top-row pinning via grid areas (prevents Player B from dropping) === */
.row{
  display: grid;
  grid-template-columns: 1fr 500px 1fr;
  grid-template-areas:
    "playerA setup playerB"
    ".       deck  ."
    ".       log   .";
  gap: 18px;
  grid-auto-flow: row dense;
}

/* Map panels to grid areas */
.panel.p1      { grid-area: playerA; }  /* Player A (left)    */
.panel.setup   { grid-area: setup; }    /* Setup (center)     */
.panel.p2      { grid-area: playerB; }  /* Player B (right)   */

/* Center strip panels */
.panel.deck,
.panel.deckpanel { grid-area: deck; }   /* supports either class */
.panel.logpanel  { grid-area: log; }

/* Masonry cascade only for the deck panel (if youâ€™re using .deckpanel) */
.deckpanel .cards{
  display: block;
  column-count: 2;
  column-gap: 16px;
  padding-bottom: 4px;
}
.deckpanel .card{
  width: auto;
/*  display: inline-block; */
  break-inside: avoid;
  margin: 0 0 12px;
}

/* Keep side panels normal flex layout */
.p1 .cards, .p2 .cards{ display:flex; flex-wrap:wrap; gap:10px; }

/* Responsive: collapse to one column under 1100px */
@media (max-width:1100px){
  .row{
    grid-template-columns: 1fr;
    grid-template-areas:
      "playerA"
      "setup"
      "playerB"
      "deck"
      "log";
  }
  .deckpanel .cards{ column-count: 1; }
}

/* =========================
   Motion preferences
   ========================= */
@media (prefers-reduced-motion: reduce){
  *{ animation:none !important; transition:none !important; }
}

/* =========================
   Responsive tweaks
   ========================= */
@media (max-width:1100px){
  .row{ grid-template-columns:1fr; }
  .cards .card{ width:104px; } /* aspect-ratio keeps 2:3 */
}
